import{Ib as G,b as R}from"./chunk-PWE762GQ.js";import"./chunk-KCPBWWW5.js";import"./chunk-E4P7UJ3O.js";import{a as I}from"./chunk-OEY3IFP3.js";import"./chunk-VOEI7TUP.js";import{c as F,e as v,g as N,h as T,i as j,k as w,m as D,q as z,r as A}from"./chunk-BOVGGUWC.js";import"./chunk-OSOTXYSP.js";import"./chunk-YB6GNKOU.js";import{a as c}from"./chunk-JB324THB.js";import{Ca as r,Dc as E,Ec as L,Fc as x,Ha as u,Jb as _,Ma as M,Na as b,Ra as p,U as f,Ua as O,Wa as a,cb as n,db as o,dc as y,eb as g,fc as k,kb as C,lb as h,pc as S,wb as l,yb as P}from"./chunk-VPSRVESD.js";import"./chunk-EQDQRRRY.js";var q=t=>({"is-invalid":t});function Y(t,m){t&1&&(n(0,"div"),l(1," Ingrese el correo electr\xF3nico asociado a su cuenta. "),o())}function J(t,m){t&1&&(n(0,"div"),l(1," Correo no v\xE1lido. "),o())}function H(t,m){if(t&1&&(n(0,"div",36),p(1,Y,2,0,"div",33)(2,J,2,0,"div",33),o()),t&2){let i=h();r(),a("ngIf",i.f.email.errors==null?null:i.f.email.errors.required),r(),a("ngIf",i.f.email.errors==null?null:i.f.email.errors.email)}}function K(t,m){t&1&&(n(0,"div"),l(1," La contrase\xF1a es requerida. "),o())}function Q(t,m){if(t&1&&(n(0,"div",36),p(1,K,2,0,"div",33),o()),t&2){let i=h();r(),a("ngIf",i.f.password.errors==null?null:i.f.password.errors.required)}}function W(t,m){t&1&&(n(0,"div",37)(1,"strong"),l(2,"Error:"),o(),l(3," Usuario o contrase\xF1a incorrectos. "),n(4,"button",38),g(5,"span",39),o()())}function X(t,m){if(t&1&&(n(0,"div",40)(1,"strong"),l(2,"Atenci\xF3n:"),o(),l(3),n(4,"button",38),g(5,"span",39),o()()),t&2){let i=h();r(3),P(" ",i.unverifiedMsg," ")}}function Z(t,m){t&1&&(n(0,"span"),l(1,"Login"),o())}function $(t,m){t&1&&(n(0,"span"),g(1,"i",41),l(2," Cargando... "),o())}var V=(()=>{class t{constructor(i,s,e){this.auth=i,this.router=s,this.profileService=e,this.routes=c,this.passwordClass=!1,this.ERROR=!1,this.loading=!1,this.unverifiedMsg="",this.form=new j({email:new w("",[v.required,v.email]),password:new w("",[v.required])})}ngOnInit(){}get f(){return this.form.controls}loginFormSubmit(){if(this.form.invalid)return;this.ERROR=!1,this.unverifiedMsg="",this.loading=!0;let{email:i,password:s}=this.form.value;this.auth.login(i||"",s||"").subscribe({next:e=>{this.loading=!1,e?.success?this.redirectByRole():e?.unverified?(this.unverifiedMsg="Tu cuenta no est\xE1 verificada. Te hemos enviado un nuevo c\xF3digo.",this.router.navigate(["/verify-code"])):this.ERROR=!0},error:e=>{this.loading=!1,this.ERROR=!0}})}togglePassword(){this.passwordClass=!this.passwordClass}redirectByRole(){let s=JSON.parse(localStorage.getItem("user")||"null")?.roles||[];s.length?this.processRolesAndNavigate(s):this.profileService.getProfile().subscribe({next:e=>{let d=e?.roles||[];this.processRolesAndNavigate(d)},error:()=>this.router.navigate([c.adminDashboard])})}processRolesAndNavigate(i){let e=i.map(d=>typeof d=="string"?d:d?.name||"").filter(Boolean).map(d=>d.trim()).map(d=>d.toLowerCase());e.includes("archivo")||e.includes("archive")?this.router.navigate([c.archiveDashboard]):e.includes("doctor")?this.router.navigate([c.doctorDashboard]):e.includes("patient")||e.includes("paciente")?this.router.navigate([c.patientDashboard]):e.includes("director general")?this.router.navigate([c.adminDashboard]):e.includes("subdirector general")?this.router.navigate([c.adminDashboard]):e.includes("developer")?this.router.navigate([c.adminDashboard]):this.router.navigate([c.adminDashboard])}static{this.\u0275fac=function(s){return new(s||t)(u(I),u(E),u(R))}}static{this.\u0275cmp=M({type:t,selectors:[["app-login"]],standalone:!1,decls:46,vars:19,consts:[[1,"main-wrapper","login-body","dark-mode"],[1,"container-fluid","px-0"],[1,"row"],[1,"col-lg-6","login-wrap"],[1,"login-sec"],[1,"log-img"],["src","assets/img/login-02.png","alt","Imagen del hospital IMSS",1,"img-fluid"],[1,"col-lg-6","login-wrap-bg"],[1,"login-wrapper"],[1,"loginbox"],[1,"login-right"],[1,"login-right-wrap"],[1,"account-logo","text-center"],[3,"routerLink"],["src","assets/img/login-logo.png","alt","Logo SISMEG"],[1,"text-center"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","email",1,"mb-2"],[1,"login-danger"],[2,"height","12px"],["aria-label","Correo electr\xF3nico","id","email","type","email","formControlName","email",1,"form-control","transition-all",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],[1,"form-group","password-group"],["for","password",1,"mb-2"],[1,"password-wrapper"],["aria-label","Contrase\xF1a","id","password","formControlName","password",1,"form-control","pass-input",3,"type","ngClass"],["type","button",1,"toggle-password-btn",3,"click"],[3,"ngClass"],["class","alert alert-danger alert-dismissible fade show","role","alert",4,"ngIf"],["class","alert alert-warning alert-dismissible fade show","role","alert",4,"ngIf"],[1,"form-group","login-btn"],["type","submit",1,"btn","btn-primary","btn-block",3,"disabled"],[4,"ngIf"],[1,"text-center","mt-3"],[1,"text-muted",3,"routerLink"],[1,"invalid-feedback"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show"],["type","button","data-bs-dismiss","alert","aria-label","Cerrar",1,"btn-close"],["aria-hidden","true"],["role","alert",1,"alert","alert-warning","alert-dismissible","fade","show"],[1,"fa","fa-spinner","fa-spin","me-2"]],template:function(s,e){s&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),g(6,"img",6),o()()(),n(7,"div",7)(8,"div",8)(9,"div",9)(10,"div",10)(11,"div",11)(12,"div",12)(13,"a",13),g(14,"img",14),o()(),n(15,"h2",15),l(16,"Iniciar Sesi\xF3n"),o(),n(17,"form",16),C("ngSubmit",function(){return e.loginFormSubmit()}),n(18,"div",17)(19,"label",18),l(20," Correo electr\xF3nico "),n(21,"span",19),l(22,"*"),o()(),g(23,"div",20)(24,"input",21),p(25,H,3,2,"div",22),o(),n(26,"div",23)(27,"label",24),l(28," Contrase\xF1a "),n(29,"span",19),l(30,"*"),o()(),g(31,"div",20),n(32,"div",25),g(33,"input",26),n(34,"button",27),C("click",function(){return e.togglePassword()}),g(35,"i",28),o()(),p(36,Q,2,1,"div",22),o(),p(37,W,6,0,"div",29)(38,X,6,1,"div",30),n(39,"div",31)(40,"button",32),p(41,Z,2,0,"span",33)(42,$,3,0,"span",33),o()(),n(43,"div",34)(44,"a",35),l(45," \xBFOlvidaste tu contrase\xF1a? "),o()()()()()()()()()()()),s&2&&(r(13),a("routerLink",e.routes.adminDashboard),r(4),a("formGroup",e.form),r(7),a("ngClass",_(15,q,e.f.email.touched&&e.f.email.invalid)),r(),a("ngIf",e.f.email.touched&&e.f.email.invalid),r(8),a("type",e.passwordClass?"text":"password")("ngClass",_(17,q,e.f.password.touched&&e.f.password.invalid)),r(),O("aria-label",e.passwordClass?"Ocultar contrase\xF1a":"Mostrar contrase\xF1a"),r(),a("ngClass",e.passwordClass?"feather icon-eye":"feather icon-eye-off"),r(),a("ngIf",e.f.password.touched&&e.f.password.invalid),r(),a("ngIf",e.ERROR),r(),a("ngIf",e.unverifiedMsg),r(2),a("disabled",e.form.invalid||e.loading),r(),a("ngIf",!e.loading),r(),a("ngIf",e.loading),r(2),a("routerLink",e.routes.forgotPassword))},dependencies:[y,k,L,D,F,N,T,z,A],styles:['@charset "UTF-8";.login-wrapper[_ngcontent-%COMP%]{background:#fff;border-radius:24px;box-shadow:0 8px 32px #2c3e5021;padding:3rem 2.5rem 2.5rem;margin:0 auto;max-width:520px;width:100%;position:relative;z-index:2;display:flex;flex-direction:column;align-items:center}body.dark-mode[_ngcontent-%COMP%]   .login-wrapper[_ngcontent-%COMP%]{background:#23272f;color:#fff;box-shadow:0 8px 32px #00000052}.loginbox[_ngcontent-%COMP%], .login-right[_ngcontent-%COMP%], .login-right-wrap[_ngcontent-%COMP%]{background:transparent!important;box-shadow:none!important;padding:0!important;margin:0!important;-webkit-backdrop-filter:none!important;backdrop-filter:none!important}.account-logo[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-bottom:2.5rem;width:270px;height:270px;border-radius:50%;background:#fff;box-shadow:0 4px 32px #2c3e5021;margin-left:auto;margin-right:auto;position:relative}.account-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:320px;width:320px;height:320px;object-fit:contain;margin-bottom:0;filter:drop-shadow(0 2px 12px rgba(44,62,80,.13));border-radius:50%;border:none;background:transparent;padding:0;display:block;margin-left:auto;margin-right:auto;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}h2.text-center[_ngcontent-%COMP%]{font-weight:700;font-size:2rem;margin-bottom:2rem;color:#2e37a4;letter-spacing:.5px}body.dark-mode[_ngcontent-%COMP%]   h2.text-center[_ngcontent-%COMP%]{color:#fff}.form-group[_ngcontent-%COMP%]{position:relative;margin-bottom:2rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:1.08rem;color:#111!important;font-weight:600;margin-bottom:1.1rem;display:block}body.dark-mode[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#fff}.form-control[_ngcontent-%COMP%]{border-radius:12px;padding:.85rem 1.2rem;font-size:1.08rem;background:#232323;color:#fff;border:1.5px solid #232323;transition:border .2s,box-shadow .2s;box-shadow:0 2px 8px #3b82f60f}.form-control[_ngcontent-%COMP%]:focus{border-color:#2e37a4;box-shadow:0 0 0 4px #2e37a421;background:#fff;color:#222}.form-control[_ngcontent-%COMP%]::placeholder{color:#888}body.dark-mode[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background:#23272f;color:#fff;border:2px solid #3b82f6}body.dark-mode[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{background:#23272f;border-color:#60a5fa;box-shadow:0 0 0 4px #3b82f62e}body.dark-mode[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]::placeholder{color:#bbb}.password-group[_ngcontent-%COMP%], .password-wrapper[_ngcontent-%COMP%]{position:relative}.pass-input[_ngcontent-%COMP%]{padding-right:3.2rem!important}.toggle-password-btn[_ngcontent-%COMP%]{position:absolute;top:50%;right:.8rem;transform:translateY(-50%);background:transparent;border:none;padding:.4rem;font-size:1.2rem;color:#888;cursor:pointer;display:flex;align-items:center;justify-content:center;z-index:3;border-radius:50%;transition:color .2s,background .2s}.toggle-password-btn[_ngcontent-%COMP%]:hover, .toggle-password-btn[_ngcontent-%COMP%]:focus{color:#2e37a4;background:#2e37a40d}body.dark-mode[_ngcontent-%COMP%]   .toggle-password-btn[_ngcontent-%COMP%]{color:#bbb}body.dark-mode[_ngcontent-%COMP%]   .toggle-password-btn[_ngcontent-%COMP%]:hover, body.dark-mode[_ngcontent-%COMP%]   .toggle-password-btn[_ngcontent-%COMP%]:focus{color:#60a5fa;background:#60a5fa1a}.login-btn[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{border-radius:12px;font-size:1.18rem;font-weight:700;padding:.95rem 0;background:linear-gradient(90deg,#2e37a4 60%,#60a5fa);color:#fff;box-shadow:0 4px 16px #3b82f621;transition:all .2s ease}.login-btn[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:disabled{background:#e5e7eb;color:#b3b3b3;cursor:not-allowed;box-shadow:none;border:1.5px solid #d1d5db}.login-btn[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover:not(:disabled), .login-btn[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:focus:not(:disabled){background:linear-gradient(90deg,#60a5fa 60%,#2e37a4);box-shadow:0 6px 24px #3b82f62e;transform:translateY(-2px) scale(1.03)}.alert[_ngcontent-%COMP%]{border-radius:10px;font-size:1.05rem;margin-top:1rem}.text-muted[_ngcontent-%COMP%], .form-text.text-muted[_ngcontent-%COMP%], a.text-muted[_ngcontent-%COMP%], .login-wrapper[_ngcontent-%COMP%]   .text-muted[_ngcontent-%COMP%]{color:#111!important;font-size:1rem}body.dark-mode[_ngcontent-%COMP%]   .text-muted[_ngcontent-%COMP%], body.dark-mode[_ngcontent-%COMP%]   .form-text.text-muted[_ngcontent-%COMP%]{color:#bbb!important}.login-wrap[_ngcontent-%COMP%]{height:100vh;display:flex;align-items:center;justify-content:center;background:transparent;border-radius:0 32px 32px 0;overflow:hidden;box-shadow:0 8px 32px #2c3e501a}.login-sec[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.log-img[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;align-items:center;justify-content:center;border-radius:0 32px 32px 0;overflow:hidden}.log-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border-radius:0 32px 32px 0}@media (max-width: 991px){.login-wrapper[_ngcontent-%COMP%]{padding:1.2rem .5rem;margin:1.2rem 0;max-width:98vw}.account-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:120px}.login-wrap[_ngcontent-%COMP%], .log-img[_ngcontent-%COMP%], .log-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:0!important;height:auto;min-height:220px}}']})}}return t})();var ee=[{path:"",component:V}],U=(()=>{class t{static{this.\u0275fac=function(s){return new(s||t)}}static{this.\u0275mod=b({type:t})}static{this.\u0275inj=f({imports:[x.forChild(ee),x]})}}return t})();var he=(()=>{class t{static{this.\u0275fac=function(s){return new(s||t)}}static{this.\u0275mod=b({type:t})}static{this.\u0275inj=f({imports:[S,U,G]})}}return t})();export{he as LoginModule};
