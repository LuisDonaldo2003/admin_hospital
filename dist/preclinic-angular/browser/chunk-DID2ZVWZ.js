import{D as R,H as v,J as p,i as D}from"./chunk-E4P7UJ3O.js";import{Na as f,U as u,c as C,d as l,n as y,q as c,r as d,y as _}from"./chunk-VPSRVESD.js";var k=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275mod=f({type:r});static \u0275inj=u({imports:[v]})}return r})();var He=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275mod=f({type:r});static \u0275inj=u({imports:[p,k,p]})}return r})(),$=9007199254740991,b=class extends R{_data;_renderData=new l([]);_filter=new l("");_internalPageChanges=new C;_renderChangesSubscription=null;filteredData;get data(){return this._data.value}set data(e){e=Array.isArray(e)?e:[],this._data.next(e),this._renderChangesSubscription||this._filterData(e)}get filter(){return this._filter.value}set filter(e){this._filter.next(e),this._renderChangesSubscription||this._filterData(this.data)}get sort(){return this._sort}set sort(e){this._sort=e,this._updateChangeSubscription()}_sort;get paginator(){return this._paginator}set paginator(e){this._paginator=e,this._updateChangeSubscription()}_paginator;sortingDataAccessor=(e,t)=>{let i=e[t];if(D(i)){let n=Number(i);return n<$?n:i}return i};sortData=(e,t)=>{let i=t.active,n=t.direction;return!i||n==""?e:e.sort((h,m)=>{let o=this.sortingDataAccessor(h,i),s=this.sortingDataAccessor(m,i),g=typeof o,w=typeof s;g!==w&&(g==="number"&&(o+=""),w==="number"&&(s+=""));let a=0;return o!=null&&s!=null?o>s?a=1:o<s&&(a=-1):o!=null?a=1:s!=null&&(a=-1),a*(n=="asc"?1:-1)})};filterPredicate=(e,t)=>{let i=t.trim().toLowerCase();return Object.values(e).some(n=>`${n}`.toLowerCase().includes(i))};constructor(e=[]){super(),this._data=new l(e),this._updateChangeSubscription()}_updateChangeSubscription(){let e=this._sort?_(this._sort.sortChange,this._sort.initialized):y(null),t=this._paginator?_(this._paginator.page,this._internalPageChanges,this._paginator.initialized):y(null),i=this._data,n=d([i,this._filter]).pipe(c(([o])=>this._filterData(o))),h=d([n,e]).pipe(c(([o])=>this._orderData(o))),m=d([h,t]).pipe(c(([o])=>this._pageData(o)));this._renderChangesSubscription?.unsubscribe(),this._renderChangesSubscription=m.subscribe(o=>this._renderData.next(o))}_filterData(e){return this.filteredData=this.filter==null||this.filter===""?e:e.filter(t=>this.filterPredicate(t,this.filter)),this.paginator&&this._updatePaginator(this.filteredData.length),this.filteredData}_orderData(e){return this.sort?this.sortData(e.slice(),this.sort):e}_pageData(e){if(!this.paginator)return e;let t=this.paginator.pageIndex*this.paginator.pageSize;return e.slice(t,t+this.paginator.pageSize)}_updatePaginator(e){Promise.resolve().then(()=>{let t=this.paginator;if(t&&(t.length=e,t.pageIndex>0)){let i=Math.ceil(t.length/t.pageSize)-1||0,n=Math.min(t.pageIndex,i);n!==t.pageIndex&&(t.pageIndex=n,this._internalPageChanges.next())}})}connect(){return this._renderChangesSubscription||this._updateChangeSubscription(),this._renderData}disconnect(){this._renderChangesSubscription?.unsubscribe(),this._renderChangesSubscription=null}};export{He as a,b};
