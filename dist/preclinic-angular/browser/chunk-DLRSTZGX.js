import{Ib as q,b as R}from"./chunk-MUB2KIYM.js";import"./chunk-KCPBWWW5.js";import"./chunk-E4P7UJ3O.js";import{a as F}from"./chunk-MK73G5EB.js";import"./chunk-VOEI7TUP.js";import{c as L,e as C,g as T,h as N,i as j,k as O,m as D,q as z,r as A}from"./chunk-BOVGGUWC.js";import"./chunk-2PJVN743.js";import"./chunk-YB6GNKOU.js";import{a as c}from"./chunk-UYUIDONG.js";import{Ca as r,Dc as E,Ec as I,Fc as M,Ha as u,Jb as v,Ma as w,Na as b,Ra as p,U as f,Ua as P,Wa as l,cb as o,db as n,dc as y,eb as m,fc as k,kb as _,lb as h,pc as S,wb as a,yb as x}from"./chunk-VPSRVESD.js";import"./chunk-EQDQRRRY.js";var B=t=>({"is-invalid":t});function U(t,g){t&1&&(o(0,"div",30)(1,"strong"),a(2,"Error:"),n(),a(3," Usuario o contrase\xF1a incorrectos. "),n())}function J(t,g){if(t&1&&(o(0,"div",31)(1,"strong"),a(2,"Atenci\xF3n:"),n(),a(3),n()),t&2){let i=h();r(3),x(" ",i.unverifiedMsg," ")}}function H(t,g){t&1&&(o(0,"div"),a(1," Ingrese el correo electr\xF3nico asociado a su cuenta. "),n())}function K(t,g){t&1&&(o(0,"div"),a(1,"Correo no v\xE1lido."),n())}function Q(t,g){if(t&1&&(o(0,"div",32),p(1,H,2,0,"div",27)(2,K,2,0,"div",27),n()),t&2){let i=h();r(),l("ngIf",i.f.email.errors==null?null:i.f.email.errors.required),r(),l("ngIf",i.f.email.errors==null?null:i.f.email.errors.email)}}function W(t,g){t&1&&(o(0,"div"),a(1,"La contrase\xF1a es requerida."),n())}function X(t,g){if(t&1&&(o(0,"div",32),p(1,W,2,0,"div",27),n()),t&2){let i=h();r(),l("ngIf",i.f.password.errors==null?null:i.f.password.errors.required)}}function Z(t,g){t&1&&(o(0,"span"),a(1,"Acceder"),n())}function $(t,g){t&1&&(o(0,"span"),m(1,"i",33),a(2," Cargando..."),n())}var V=(()=>{class t{constructor(i,s,e){this.auth=i,this.router=s,this.profileService=e,this.routes=c,this.passwordClass=!1,this.ERROR=!1,this.loading=!1,this.unverifiedMsg="",this.form=new j({email:new O("",[C.required,C.email]),password:new O("",[C.required])})}ngOnInit(){}get f(){return this.form.controls}loginFormSubmit(){if(this.form.invalid)return;this.ERROR=!1,this.unverifiedMsg="",this.loading=!0;let{email:i,password:s}=this.form.value;this.auth.login(i||"",s||"").subscribe({next:e=>{this.loading=!1,e?.success?this.redirectByRole():e?.unverified?(this.unverifiedMsg="Tu cuenta no est\xE1 verificada. Te hemos enviado un nuevo c\xF3digo.",this.router.navigate(["/verify-code"])):this.ERROR=!0},error:e=>{this.loading=!1,this.ERROR=!0}})}togglePassword(){this.passwordClass=!this.passwordClass}redirectByRole(){let s=JSON.parse(localStorage.getItem("user")||"null")?.roles||[];s.length?this.processRolesAndNavigate(s):this.profileService.getProfile().subscribe({next:e=>{let d=e?.roles||[];this.processRolesAndNavigate(d)},error:()=>this.router.navigate([c.adminDashboard])})}processRolesAndNavigate(i){let e=i.map(d=>typeof d=="string"?d:d?.name||"").filter(Boolean).map(d=>d.trim()).map(d=>d.toLowerCase());e.includes("archivo")||e.includes("archive")?this.router.navigate([c.archiveDashboard]):e.includes("doctor")?this.router.navigate([c.doctorDashboard]):e.includes("patient")||e.includes("paciente")?this.router.navigate([c.patientDashboard]):e.includes("director general")?this.router.navigate([c.adminDashboard]):e.includes("subdirector general")?this.router.navigate([c.adminDashboard]):e.includes("developer")?this.router.navigate([c.adminDashboard]):this.router.navigate([c.adminDashboard])}static{this.\u0275fac=function(s){return new(s||t)(u(F),u(E),u(R))}}static{this.\u0275cmp=w({type:t,selectors:[["app-login"]],standalone:!1,decls:42,vars:18,consts:[[1,"auth-layout"],["aria-label","Imagen del hospital",1,"side-visual"],[1,"image-frame"],["src","assets/img/login-02.png","alt","Fachada del hospital IMSS Bienestar"],["aria-labelledby","authTitle",1,"auth-col"],["role","form",1,"auth-panel"],["aria-label","Ir al inicio",1,"brand"],["src","assets/img/login-logo.png","alt","Logo SISMEG"],["id","authTitle",1,"title"],[1,"subtitle"],["class","alert alert-danger","role","alert","aria-live","assertive",4,"ngIf"],["class","alert alert-warning","role","alert","aria-live","polite",4,"ngIf"],["novalidate","",3,"ngSubmit","formGroup"],[1,"field"],["for","email"],[1,"req"],[1,"control","with-icon"],["id","email","aria-label","Correo electr\xF3nico","type","email","placeholder","nombre.apellido@dominio.com","formControlName","email",1,"form-control",3,"ngClass"],["aria-hidden","true",1,"feather","icon-mail","field-icon"],["class","invalid-feedback",4,"ngIf"],["for","password"],["id","password","aria-label","Contrase\xF1a","placeholder","Tu contrase\xF1a","formControlName","password",1,"form-control","pass-input",3,"type","ngClass"],["type","button",1,"toggle-password-btn",3,"click"],["aria-hidden","true",3,"ngClass"],["aria-hidden","true",1,"feather","icon-lock","field-icon"],[1,"actions"],["type","submit",1,"btn","btn-primary","w-100",3,"disabled"],[4,"ngIf"],[1,"footer-links"],[1,"muted",3,"routerLink"],["role","alert","aria-live","assertive",1,"alert","alert-danger"],["role","alert","aria-live","polite",1,"alert","alert-warning"],[1,"invalid-feedback"],[1,"fa","fa-spinner","fa-spin","me-2"]],template:function(s,e){s&1&&(o(0,"div",0)(1,"aside",1)(2,"div",2),m(3,"img",3),n()(),o(4,"main",4)(5,"section",5)(6,"a",6),m(7,"img",7),n(),o(8,"h1",8),a(9,"Iniciar sesi\xF3n"),n(),o(10,"p",9),a(11,"Accede con tus credenciales institucionales"),n(),p(12,U,4,0,"div",10)(13,J,4,1,"div",11),o(14,"form",12),_("ngSubmit",function(){return e.loginFormSubmit()}),o(15,"div",13)(16,"label",14),a(17,"Correo electr\xF3nico "),o(18,"span",15),a(19,"*"),n()(),o(20,"div",16),m(21,"input",17)(22,"i",18),n(),p(23,Q,3,2,"div",19),n(),o(24,"div",13)(25,"label",20),a(26,"Contrase\xF1a "),o(27,"span",15),a(28,"*"),n()(),o(29,"div",16),m(30,"input",21),o(31,"button",22),_("click",function(){return e.togglePassword()}),m(32,"i",23),n(),m(33,"i",24),n(),p(34,X,2,1,"div",19),n(),o(35,"div",25)(36,"button",26),p(37,Z,2,0,"span",27)(38,$,3,0,"span",27),n()(),o(39,"div",28)(40,"a",29),a(41,"\xBFOlvidaste tu contrase\xF1a?"),n()()()()()()),s&2&&(r(12),l("ngIf",e.ERROR),r(),l("ngIf",e.unverifiedMsg),r(),l("formGroup",e.form),r(7),l("ngClass",v(14,B,e.f.email.touched&&e.f.email.invalid)),r(2),l("ngIf",e.f.email.touched&&e.f.email.invalid),r(7),l("type",e.passwordClass?"text":"password")("ngClass",v(16,B,e.f.password.touched&&e.f.password.invalid)),r(),P("aria-label",e.passwordClass?"Ocultar contrase\xF1a":"Mostrar contrase\xF1a"),r(),l("ngClass",e.passwordClass?"feather icon-eye":"feather icon-eye-off"),r(2),l("ngIf",e.f.password.touched&&e.f.password.invalid),r(2),l("disabled",e.form.invalid||e.loading),r(),l("ngIf",!e.loading),r(),l("ngIf",e.loading),r(2),l("routerLink",e.routes.forgotPassword))},dependencies:[y,k,I,D,L,T,N,z,A],styles:[`@charset "UTF-8";.auth-layout[_ngcontent-%COMP%]{min-height:100vh;display:grid;grid-template-columns:1.2fr 1fr;background:#0f1115;overflow-x:hidden}.side-visual[_ngcontent-%COMP%]{position:relative;overflow:hidden;border-radius:0 28px 28px 0;box-shadow:inset 0 0 0 1px #ffffff0a;max-width:100%}.image-frame[_ngcontent-%COMP%]{width:100%;height:100%;max-height:100vh}.side-visual[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto;max-height:100vh;max-width:100%;object-fit:cover;display:block;transform-origin:center}.auth-col[_ngcontent-%COMP%]{display:grid;place-items:center;padding:clamp(.6rem,2vw,1.6rem)}.auth-panel[_ngcontent-%COMP%]{width:min(520px,92vw);color:#0f172a;background:#fff;border-radius:22px;padding:clamp(.9rem,2.2vw,1.4rem) clamp(.9rem,2.2vw,1.4rem);box-shadow:0 10px 35px #0000002e,0 2px 8px #00000014;position:relative;display:flex;flex-direction:column;justify-content:center;gap:.6rem}body.dark-mode[_ngcontent-%COMP%]   .auth-layout[_ngcontent-%COMP%]{background:#0b0f1a}body.dark-mode[_ngcontent-%COMP%]   .auth-panel[_ngcontent-%COMP%]{background:#161a23;color:#e5e7eb;box-shadow:0 10px 35px #00000059}.brand[_ngcontent-%COMP%]{width:clamp(120px,20vw,260px);height:clamp(120px,20vw,260px);display:grid;place-items:center;margin:0 auto 1rem;border-radius:50%;background:radial-gradient(120px 120px at 50% 50%,#fff 0,#f6f7ff 60%,#e9efff);box-shadow:0 8px 36px #3b82f62e;position:static;z-index:3}.brand[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:78%;height:auto;display:block;object-fit:contain;filter:drop-shadow(0 6px 18px rgba(46,55,164,.22))}body.dark-mode[_ngcontent-%COMP%]   .brand[_ngcontent-%COMP%]{background:radial-gradient(110px 110px at 50% 50%,#1b2231 0,#141a28);box-shadow:0 6px 28px #2e37a440}.title[_ngcontent-%COMP%]{text-align:center;font-weight:800;font-size:clamp(1.45rem,2.2vw,1.9rem);margin:0 0 .25rem;color:#2e37a4}body.dark-mode[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:#e5e7ff}.subtitle[_ngcontent-%COMP%]{text-align:center;margin:0 0 1.25rem;color:#64748b}body.dark-mode[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{color:#a3b2cc}.field[_ngcontent-%COMP%]{margin-bottom:1.25rem}.field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;display:inline-block;margin-bottom:.55rem;color:#0f172a}body.dark-mode[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#e5e7eb}.req[_ngcontent-%COMP%]{color:#ef4444}.control[_ngcontent-%COMP%]{position:relative}.control[_ngcontent-%COMP%]{overflow:visible}.with-icon[_ngcontent-%COMP%]   .field-icon[_ngcontent-%COMP%]{position:absolute;left:.85rem;top:50%;transform:translateY(-50%);color:#8a94a6;pointer-events:none}.form-control[_ngcontent-%COMP%]{width:100%;border-radius:12px;padding:.9rem 1rem .9rem 2.4rem;font-size:1.03rem;border:1px solid #e5e7eb;background:#f9fafb;color:#0f172a;transition:border-color .18s ease,box-shadow .18s ease,background .18s ease}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#2e37a4;background:#fff;box-shadow:0 0 0 4px #2e37a426}.form-control[_ngcontent-%COMP%]::placeholder{color:#94a3b8}body.dark-mode[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background:#1a2030;color:#e5e7eb;border:1px solid #3b82f6}body.dark-mode[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{border-color:#60a5fa;box-shadow:0 0 0 4px #3b82f640;background:#161a23}body.dark-mode[_ngcontent-%COMP%]   .with-icon[_ngcontent-%COMP%]   .field-icon[_ngcontent-%COMP%]{color:#9fb3d9}.pass-input[_ngcontent-%COMP%]{padding-right:3.8rem!important}.toggle-password-btn[_ngcontent-%COMP%]{position:absolute;right:.5rem;top:50%;transform:translateY(-50%);border:0;background:#0000000a;color:#374151;width:2.6rem;height:2.6rem;display:grid;place-items:center;border-radius:8px;transition:background .14s ease,color .14s ease,transform .12s ease;z-index:22}.toggle-password-btn[_ngcontent-%COMP%]:hover, .toggle-password-btn[_ngcontent-%COMP%]:focus{color:#2e37a4;background:#2e37a414}body.dark-mode[_ngcontent-%COMP%]   .toggle-password-btn[_ngcontent-%COMP%]{color:#cbd5e1;background:#ffffff08}body.dark-mode[_ngcontent-%COMP%]   .toggle-password-btn[_ngcontent-%COMP%]:hover, body.dark-mode[_ngcontent-%COMP%]   .toggle-password-btn[_ngcontent-%COMP%]:focus{color:#60a5fa;background:#60a5fa1f}.toggle-password-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .toggle-password-btn[_ngcontent-%COMP%]   .feather[_ngcontent-%COMP%], .toggle-password-btn[_ngcontent-%COMP%]   .fa[_ngcontent-%COMP%], .toggle-password-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#fff!important;fill:none!important;stroke:#fff!important}.toggle-password-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%], .toggle-password-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   line[_ngcontent-%COMP%], .toggle-password-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%], .toggle-password-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   rect[_ngcontent-%COMP%]{stroke:#fff!important;fill:none!important}.toggle-password-btn[_ngcontent-%COMP%]   .feather[_ngcontent-%COMP%], .toggle-password-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .toggle-password-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:20px!important;height:20px!important;display:block!important}.toggle-password-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{background-repeat:no-repeat!important;background-position:center!important;background-size:20px 20px!important;color:transparent!important;font-size:0!important;line-height:0!important}.toggle-password-btn[_ngcontent-%COMP%]   i.icon-eye[_ngcontent-%COMP%]{background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M1 12s4-8 11-8 11 8 11 8-4 8-11 8S1 12 1 12z'/><circle cx='12' cy='12' r='3'/></svg>")}.toggle-password-btn[_ngcontent-%COMP%]   i.icon-eye-off[_ngcontent-%COMP%]{background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M17.94 17.94A10.94 10.94 0 0 1 12 20c-7 0-11-8-11-8a21.46 21.46 0 0 1 5.06-6.94'/><path d='M1 1l22 22'/></svg>")}.btn[_ngcontent-%COMP%]{border:0;cursor:pointer}.btn-primary[_ngcontent-%COMP%]{--c1: #2e37a4;--c2: #60a5fa;background:linear-gradient(90deg,var(--c1),var(--c2));color:#fff;font-weight:700;letter-spacing:.15px;padding:.95rem 1rem;border-radius:12px;box-shadow:0 8px 22px #3b82f62e;transition:transform .12s ease,box-shadow .18s ease,filter .18s ease}.btn-primary[_ngcontent-%COMP%]:hover{transform:translateY(-1px);filter:saturate(1.05);box-shadow:0 12px 28px #3b82f640}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.55;cursor:not-allowed;box-shadow:none;filter:grayscale(.1)}.w-100[_ngcontent-%COMP%]{width:100%}.actions[_ngcontent-%COMP%]{margin-top:.35rem}.footer-links[_ngcontent-%COMP%]{text-align:center;margin-top:1rem}.muted[_ngcontent-%COMP%]{color:#6b7280!important;font-size:.98rem}body.dark-mode[_ngcontent-%COMP%]   .muted[_ngcontent-%COMP%]{color:#b3c0d6!important}.alert[_ngcontent-%COMP%]{border-radius:12px;padding:.8rem 1rem;margin-bottom:1rem;font-size:.98rem}.alert-danger[_ngcontent-%COMP%]{background:#fee2e2;color:#7f1d1d;border:1px solid #fecaca}.alert-warning[_ngcontent-%COMP%]{background:#fff7ed;color:#7c2d12;border:1px solid #ffedd5}body.dark-mode[_ngcontent-%COMP%]   .alert-danger[_ngcontent-%COMP%]{background:#341a1a;color:#fecaca;border-color:#7f1d1d}body.dark-mode[_ngcontent-%COMP%]   .alert-warning[_ngcontent-%COMP%]{background:#2b1f12;color:#ffedd5;border-color:#7c2d12}@media (max-width: 1100px){.auth-layout[_ngcontent-%COMP%]{grid-template-columns:1fr}.side-visual[_ngcontent-%COMP%]{height:28vh;border-radius:0;box-shadow:none}}@media (max-width: 560px){.brand[_ngcontent-%COMP%]{width:160px;height:160px;top:12px}.brand[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:78%}.auth-panel[_ngcontent-%COMP%]{padding:1.25rem;border-radius:18px}}`]})}}return t})();var ee=[{path:"",component:V}],Y=(()=>{class t{static{this.\u0275fac=function(s){return new(s||t)}}static{this.\u0275mod=b({type:t})}static{this.\u0275inj=f({imports:[M.forChild(ee),M]})}}return t})();var he=(()=>{class t{static{this.\u0275fac=function(s){return new(s||t)}}static{this.\u0275mod=b({type:t})}static{this.\u0275inj=f({imports:[S,Y,q]})}}return t})();export{he as LoginModule};
