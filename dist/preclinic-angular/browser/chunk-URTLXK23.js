import{a as $}from"./chunk-KXU5C2WY.js";import{a as W}from"./chunk-EMJYMGAB.js";import{Ib as X,f as Y,g as K}from"./chunk-PWE762GQ.js";import"./chunk-KCPBWWW5.js";import"./chunk-E4P7UJ3O.js";import"./chunk-OEY3IFP3.js";import"./chunk-VOEI7TUP.js";import"./chunk-BOVGGUWC.js";import"./chunk-OSOTXYSP.js";import{b as z,c as U,d as j}from"./chunk-YB6GNKOU.js";import{a as F}from"./chunk-JB324THB.js";import{Ca as i,Ec as L,Fc as A,Ha as M,Lb as _,Ma as B,Mb as T,Na as C,Nb as r,Ob as o,Qb as y,Ra as x,U as v,Wa as f,Xa as D,ba as E,ca as k,cb as n,db as a,dc as V,eb as g,ec as N,fc as G,ib as H,kb as P,lb as h,pc as R,vb as O,wb as l,xb as s,yb as S,zb as w}from"./chunk-VPSRVESD.js";import"./chunk-EQDQRRRY.js";var Z=(t,d,e)=>({t,s:d,v:e,ic:"fa-calendar-day"}),ee=(t,d,e)=>({t,s:d,v:e,ic:"fa-layer-group"}),te=(t,d,e)=>({t,s:d,v:e,ic:"fa-chart-column"}),ie=(t,d,e)=>({t,s:d,v:e,ic:"fa-database"}),ne=(t,d,e,p)=>[t,d,e,p];function ae(t,d){if(t&1&&(n(0,"div",36)(1,"div",37),g(2,"i",38),a(),n(3,"div",39)(4,"div",40),l(5),n(6,"small"),l(7),a()(),n(8,"div",41),l(9),a()()()),t&2){let e=d.$implicit;i(2),f("ngClass",e.ic),i(3),S("",e.t," "),i(2),s(e.s),i(2),s(e.v)}}function re(t,d){if(t&1&&(n(0,"div",42)(1,"div",43),g(2,"div",44)(3,"div",45),a(),n(4,"ul",46)(5,"li"),g(6,"span",47),l(7),r(8,"translate"),a(),n(9,"li"),g(10,"span",48),l(11),r(12,"translate"),a()()()),t&2){let e=h(2);i(2),D("width",e.byGender.male/(e.byGender.male+e.byGender.female)*100+"%"),i(),D("width",e.byGender.female/(e.byGender.male+e.byGender.female)*100+"%"),i(4),w(" ",o(8,8,"DASHBOARD.DASHBOARD_ARCHIVE.MAN"),": ",e.byGender.male,""),i(4),w(" ",o(12,10,"DASHBOARD.DASHBOARD_ARCHIVE.WOMAN"),": ",e.byGender.female,"")}}function oe(t,d){t&1&&(n(0,"div",49),l(1),r(2,"translate"),a()),t&2&&(i(),s(o(2,1,"DASHBOARD.DASHBOARD_ARCHIVE.NOT_DATES")))}function le(t,d){if(t&1&&(n(0,"div",52)(1,"div",53),l(2),a(),n(3,"div",54)(4,"div",55),l(5),a(),n(6,"div",56),g(7,"span",57),a()(),n(8,"div",58),l(9),a()()),t&2){let e=d.$implicit,p=d.index,c=h(3);i(2),s(p+1),i(2),f("title",e.state),i(),s(e.state),i(2),D("width",e.count/c.byState[0].count*100+"%"),i(2),s(e.count)}}function de(t,d){if(t&1&&(n(0,"div",50),x(1,le,10,6,"div",51),a()),t&2){let e=h(2);i(),f("ngForOf",e.byState)}}function pe(t,d){t&1&&(n(0,"div",49),l(1),r(2,"translate"),a()),t&2&&(i(),s(o(2,1,"DASHBOARD.DASHBOARD_ARCHIVE.NOT_REGISTERS")))}function ce(t,d){if(t&1&&g(0,"apx-chart",63),t&2){let e=h(3);f("series",e.weeklyChart.series)("chart",e.weeklyChart.chart)("xaxis",e.weeklyChart.xaxis)("yaxis",e.weeklyChart.yaxis)("dataLabels",e.weeklyChart.dataLabels)("stroke",e.weeklyChart.stroke)("grid",e.weeklyChart.grid)("tooltip",e.weeklyChart.tooltip)("fill",e.weeklyChart.fill)}}function se(t,d){if(t&1&&(n(0,"section",59)(1,"div",60)(2,"header",20)(3,"h3"),l(4),r(5,"translate"),a()(),n(6,"div",61),x(7,ce,1,9,"apx-chart",62),a()()()),t&2){let e=h(2);i(4),s(o(5,2,"DASHBOARD.DASHBOARD_ARCHIVE.RECENT_REGISTERS")),i(3),f("ngIf",e.weeklyChart)}}function me(t,d){if(t&1&&(n(0,"div",64),l(1),a()),t&2){let e=h(2);i(),s(e.error)}}function ge(t,d){if(t&1){let e=H();n(0,"div",4)(1,"div",5)(2,"ul",6)(3,"li",7)(4,"a"),l(5),r(6,"translate"),a()(),n(7,"li",8),l(8),r(9,"translate"),a()(),n(10,"section",9)(11,"div",10)(12,"div",11)(13,"h1")(14,"span"),l(15),r(16,"translate"),a(),l(17),r(18,"translate"),a(),n(19,"p"),l(20),r(21,"translate"),a()(),n(22,"div",12)(23,"button",13),P("click",function(){E(e);let c=h();return k(c.loadStats())}),g(24,"i",14),a()()(),g(25,"div",15),a(),n(26,"section",16),x(27,ae,10,4,"div",17),r(28,"translate"),r(29,"translate"),r(30,"translate"),r(31,"translate"),r(32,"translate"),r(33,"translate"),r(34,"translate"),r(35,"translate"),a(),n(36,"div",18)(37,"div",19)(38,"header",20)(39,"h3"),l(40),r(41,"translate"),a()(),x(42,re,13,12,"div",21)(43,oe,3,3,"ng-template",null,1,y),a(),n(45,"div",22)(46,"header",20)(47,"h3"),l(48),r(49,"translate"),a()(),x(50,de,2,1,"div",23)(51,pe,3,3,"ng-template",null,2,y),a(),n(53,"div",24)(54,"header",20)(55,"h3"),l(56),r(57,"translate"),a()(),n(58,"div",25)(59,"button",26),g(60,"i",27),n(61,"span"),l(62),r(63,"translate"),a()(),n(64,"button",28),g(65,"i",29),n(66,"span"),l(67),r(68,"translate"),a()(),n(69,"button",30),g(70,"i",31),n(71,"span"),l(72),r(73,"translate"),a()(),n(74,"button",32),g(75,"i",33),n(76,"span"),l(77),r(78,"translate"),a()()()()(),x(79,se,8,4,"section",34)(80,me,2,1,"div",35),a()()}if(t&2){let e=O(44),p=O(52),c=h();i(5),S("",o(6,19,"DASHBOARD.DASHBOARD_ARCHIVE.DASHBOARD")," >"),i(3),s(o(9,21,"DASHBOARD.DASHBOARD_ARCHIVE.ARCHIVE")),i(7),s(o(16,23,"DASHBOARD.DASHBOARD_ARCHIVE.ARCHIVE")),i(2),S(" | ",o(18,25,"DASHBOARD.DASHBOARD_ARCHIVE.SUMMARY"),""),i(3),s(o(21,27,"DASHBOARD.DASHBOARD_ARCHIVE.VISION")),i(7),f("ngForOf",T(75,ne,_(59,Z,o(28,29,"DASHBOARD.DASHBOARD_ARCHIVE.TODAY"),o(29,31,"DASHBOARD.DASHBOARD_ARCHIVE.REGISTER"),c.stats.todayAdded),_(63,ee,o(30,33,"DASHBOARD.DASHBOARD_ARCHIVE.WEEK"),o(31,35,"DASHBOARD.DASHBOARD_ARCHIVE.ACCUMULATED"),c.stats.weekAdded),_(67,te,o(32,37,"DASHBOARD.DASHBOARD_ARCHIVE.MONTH"),o(33,39,"DASHBOARD.DASHBOARD_ARCHIVE.ACCUMULATED"),c.stats.monthAdded),_(71,ie,o(34,41,"DASHBOARD.DASHBOARD_ARCHIVE.TOTAL"),o(35,43,"DASHBOARD.DASHBOARD_ARCHIVE.HISTORICAL"),c.stats.totalArchives))),i(13),s(o(41,45,"DASHBOARD.DASHBOARD_ARCHIVE.DISTRIBUTION_BY_GENDER")),i(2),f("ngIf",c.byGender.male+c.byGender.female>0)("ngIfElse",e),i(6),s(o(49,47,"DASHBOARD.DASHBOARD_ARCHIVE.TOP_LOCATIONS")),i(2),f("ngIf",c.byState.length)("ngIfElse",p),i(6),s(o(57,49,"DASHBOARD.DASHBOARD_ARCHIVE.ACTIONS")),i(6),s(o(63,51,"DASHBOARD.DASHBOARD_ARCHIVE.NEW")),i(5),s(o(68,53,"DASHBOARD.DASHBOARD_ARCHIVE.LIST")),i(5),s(o(73,55,"DASHBOARD.DASHBOARD_ARCHIVE.EXPORT")),i(5),s(o(78,57,"DASHBOARD.DASHBOARD_ARCHIVE.BACKUP")),i(2),f("ngIf",c.weeklyChart),i(),f("ngIf",c.error)}}function fe(t,d){t&1&&(n(0,"div",4)(1,"div",65)(2,"div",66),l(3),r(4,"translate"),a()()()),t&2&&(i(3),s(o(4,1,"DASHBOARD.DASHBOARD_ARCHIVE.STATISTICS_LOADING")))}var I=(()=>{class t{constructor(e,p){this.archiveService=e,this.translate=p,this.routes=F,this.todayDate=new Date,this.stats={todayAdded:0,weekAdded:0,monthAdded:0,totalArchives:0},this.loading=!0,this.error=null,this.byGender={male:0,female:0},this.byState=[],this.weeklyCategories=[],this.weeklyCounts=[],this.weeklyChart=null}ngOnInit(){this.loadStats()}loadStats(){this.loading=!0,this.archiveService.getArchiveStats().subscribe({next:e=>{e?.stats&&(this.stats=e.stats),e?.byGender&&(this.byGender=e.byGender),e?.topLocations&&(this.byState=e.topLocations.map(c=>({state:c.name,count:c.count})));let p=e?.dailySeries||e?.dailyTrend||e?.last7Days||e?.daily||null;this.prepareWeeklyChart(p),this.loading=!1},error:e=>{this.error=e?.error?.message||"Error cargando estad\xEDsticas",this.loading=!1}})}prepareWeeklyChart(e){let p=new Date,c=[];for(let m=6;m>=0;m--){let u=new Date(p);u.setDate(p.getDate()-m);let b=u.toISOString().substring(0,10);c.push({date:b,count:0})}Array.isArray(e)&&e.forEach(m=>{let u=(m.date||m.day||m.fecha||"").toString().substring(0,10),b=c.find(Q=>Q.date===u);b&&(b.count=Number(m.count||m.total||m.value||0))}),this.weeklyCategories=c.map(m=>this.formatShortDate(m.date)),this.weeklyCounts=c.map(m=>m.count),this.weeklyChart={series:[{name:"Registros",data:this.weeklyCounts}],chart:{type:"area",height:240,sparkline:{enabled:!1},toolbar:{show:!1},animations:{enabled:!0}},dataLabels:{enabled:!1},stroke:{curve:"smooth",width:3},xaxis:{categories:this.weeklyCategories,labels:{style:{colors:"#8fa2c2",fontSize:"11px"}},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{style:{colors:"#8fa2c2",fontSize:"11px"}},forceNiceScale:!0,min:0},grid:{borderColor:"rgba(255,255,255,0.06)",strokeDashArray:4,xaxis:{lines:{show:!1}}},tooltip:{theme:"dark",x:{show:!0},y:{formatter:m=>m+" pacientes"}},fill:{type:"gradient",gradient:{shadeIntensity:.4,opacityFrom:.35,opacityTo:0,stops:[0,100]}}}}formatShortDate(e){return new Date(e+"T00:00:00").toLocaleDateString("es-MX",{day:"2-digit",month:"2-digit"})}static{this.\u0275fac=function(p){return new(p||t)(M($),M(z))}}static{this.\u0275cmp=B({type:t,selectors:[["app-archive-dashboard"]],decls:3,vars:2,consts:[["loadingTpl",""],["noGender",""],["noLocations",""],["class","page-wrapper",4,"ngIf","ngIfElse"],[1,"page-wrapper"],[1,"content","archive-dash-new"],[1,"breadcrumb","mb-3"],[1,"breadcrumb-item"],[1,"breadcrumb-item","active"],[1,"hero","mb-4"],[1,"hero-inner"],[1,"hero-text"],[1,"hero-meta"],[1,"btn","btn-refresh",3,"click"],[1,"fa","fa-rotate"],[1,"hero-bg"],[1,"kpi-grid","mb-4"],["class","kpi-card",4,"ngFor","ngForOf"],[1,"grid-panels","mb-4"],[1,"panel","panel-gender"],[1,"panel-hd"],["class","gender-wrap",4,"ngIf","ngIfElse"],[1,"panel","panel-locations"],["class","locations-list",4,"ngIf","ngIfElse"],[1,"panel","actions","panel-actions"],[1,"actions-grid"],["routerLink","/archives/add_archive",1,"action"],[1,"fa","fa-plus"],["routerLink","/archives/list_archive",1,"action"],[1,"fa","fa-list"],["routerLink","/archives/export_archive",1,"action"],[1,"fa","fa-file-export"],["routerLink","/archives/backup_archive",1,"action"],[1,"fa","fa-database"],["class","weekly-chart",4,"ngIf"],["class","alert alert-danger py-2 px-3 small mb-0",4,"ngIf"],[1,"kpi-card"],[1,"kpi-icon"],[1,"fa",3,"ngClass"],[1,"kpi-body"],[1,"kpi-label"],[1,"kpi-value"],[1,"gender-wrap"],[1,"gender-bars"],["aria-label","Masculino",1,"bar"],["aria-label","Femenino",1,"bar","female"],[1,"legend"],[1,"dot","male"],[1,"dot","female"],[1,"empty"],[1,"locations-list"],["class","loc-item",4,"ngFor","ngForOf"],[1,"loc-item"],[1,"loc-rank"],[1,"loc-body"],[1,"loc-name",3,"title"],[1,"loc-meter"],[1,"meter-fill"],[1,"loc-count"],[1,"weekly-chart"],[1,"panel","panel-chart"],[1,"chart-wrapper"],[3,"series","chart","xaxis","yaxis","dataLabels","stroke","grid","tooltip","fill",4,"ngIf"],[3,"series","chart","xaxis","yaxis","dataLabels","stroke","grid","tooltip","fill"],[1,"alert","alert-danger","py-2","px-3","small","mb-0"],[1,"content"],[1,"text-center","py-5","text-muted"]],template:function(p,c){if(p&1&&x(0,ge,81,80,"div",3)(1,fe,5,3,"ng-template",null,0,y),p&2){let m=O(2);f("ngIf",!c.loading)("ngIfElse",m)}},dependencies:[R,V,N,G,A,L,K,Y,j,U],styles:['@charset "UTF-8";.archive-dash-new[_ngcontent-%COMP%]{padding-left:clamp(.75rem,1.2vw,1rem);padding-right:clamp(.75rem,1.8vw,1.25rem);overflow-x:hidden}ul.breadcrumb[_ngcontent-%COMP%]{background:transparent;padding:0;margin:0 0 .75rem;list-style:none;display:flex;gap:.5rem;font-size:.8rem;text-transform:none}ul.breadcrumb[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{opacity:.85;color:#bcd0f0}ul.breadcrumb[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{opacity:1;color:#e6eeff}ul.breadcrumb[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#8fb4ff;text-decoration:none}.hero[_ngcontent-%COMP%]{position:relative;border-radius:16px;padding:1.5rem 1.25rem;background:linear-gradient(135deg,#1f2432,#12151d);border:1px solid #262c3a;overflow:hidden}.hero-inner[_ngcontent-%COMP%]{display:flex;align-items:flex-end;justify-content:space-between;gap:1rem}.hero-text[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 .35rem;font-weight:700;font-size:1.5rem;color:#dfe7ff}.hero-text[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#6ea8ff}.hero-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#9fb4d6;opacity:.9;font-size:.95rem}.btn-refresh[_ngcontent-%COMP%]{background:#222633;border:1px solid #2e3344;color:#6ea8ff;border-radius:10px;width:42px;height:42px;display:grid;place-items:center;transition:.2s}.btn-refresh[_ngcontent-%COMP%]:hover{background:#2a3040}.kpi-grid[_ngcontent-%COMP%]{display:grid;gap:1rem;grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}.kpi-card[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;gap:.9rem;background:#171a22;border:1px solid #232936;border-radius:14px;padding:1rem 1.1rem;transition:transform .2s ease,box-shadow .2s ease}.kpi-card[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 10px 18px -10px #0009}.kpi-icon[_ngcontent-%COMP%]{width:48px;height:48px;flex:0 0 48px;border-radius:12px;display:grid;place-items:center;background:#1e2230;color:#6ea8ff;box-shadow:0 0 0 1px #2c3442 inset}.kpi-label[_ngcontent-%COMP%]{font-size:.8rem;font-weight:600;color:#9fb4d6}.kpi-label[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{margin-left:.35rem;opacity:.8}.kpi-value[_ngcontent-%COMP%]{font-size:1.9rem;font-weight:800;line-height:1;letter-spacing:-.5px;color:#e8efff;margin-top:.25rem}.grid-panels[_ngcontent-%COMP%]{display:grid;gap:1.2rem;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));align-items:start}.panel[_ngcontent-%COMP%]{background:#171a22;border:1px solid #232936;border-radius:16px;padding:1rem 1.1rem 1.1rem}.panel-hd[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .75rem;font-size:.95rem;text-transform:uppercase;letter-spacing:.6px;color:#9fb4d6;font-weight:700}.gender-wrap[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.9rem}.gender-bars[_ngcontent-%COMP%]{position:relative;display:flex;height:18px;background:#0f1217;border-radius:9px;overflow:hidden;box-shadow:0 0 0 1px #252a37 inset}.gender-bars[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]{background:linear-gradient(90deg,#4d6bff,#6088ff)}.gender-bars[_ngcontent-%COMP%]   .female[_ngcontent-%COMP%]{background:linear-gradient(90deg,#0ac8b8,#2dd6c7)}.legend[_ngcontent-%COMP%]{list-style:none;margin:0;padding:0;display:flex;gap:1rem;flex-wrap:wrap;font-size:.8rem;font-weight:600;color:#e8efff}.legend[_ngcontent-%COMP%]   .dot[_ngcontent-%COMP%]{width:10px;height:10px;border-radius:50%;display:inline-block;margin-right:.35rem;box-shadow:0 0 0 2px #fff,0 0 0 3px #ffffff0f}.legend[_ngcontent-%COMP%]   .male[_ngcontent-%COMP%]{background:#5576ff}.legend[_ngcontent-%COMP%]   .female[_ngcontent-%COMP%]{background:#0ac8b8}.empty[_ngcontent-%COMP%]{font-size:.85rem;opacity:.7;color:#a5b6cf}.locations-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.6rem}.loc-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:32px 1fr 50px;gap:.75rem;align-items:center;background:#12141b;border:1px solid #222836;padding:.6rem .7rem;border-radius:12px}.loc-rank[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:10px;display:grid;place-items:center;background:#1d212a;color:#6ea8ff;font-weight:700;box-shadow:0 0 0 1px #2a3140 inset}.loc-body[_ngcontent-%COMP%]{min-width:0}.loc-name[_ngcontent-%COMP%]{color:#d9e2f5;font-weight:600;font-size:.85rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.loc-meter[_ngcontent-%COMP%]{height:6px;background:#212730;border-radius:4px;overflow:hidden;position:relative}.meter-fill[_ngcontent-%COMP%]{position:absolute;inset:0;background:linear-gradient(90deg,#6ea8ff,#2dd6c7)}.loc-count[_ngcontent-%COMP%]{text-align:right;color:#9fb4d6;font-weight:700}.actions-grid[_ngcontent-%COMP%]{display:grid;gap:.8rem;grid-template-columns:repeat(auto-fit,minmax(120px,1fr))}.action[_ngcontent-%COMP%]{border:1px solid #2a3140;background:#14171e;border-radius:14px;padding:.85rem .55rem .7rem;font-size:.7rem;font-weight:700;text-transform:uppercase;letter-spacing:.4px;display:flex;flex-direction:column;align-items:center;gap:.55rem;color:#b8c7e2;transition:.18s}.action[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.05rem;color:#6ea8ff}.action[_ngcontent-%COMP%]:hover{background:#1d212a;color:#fff;box-shadow:0 6px 18px -8px #000;transform:translateY(-2px)}.weekly-chart[_ngcontent-%COMP%]{margin-bottom:1.25rem}.panel-chart[_ngcontent-%COMP%]{min-height:200px}.chart-wrapper[_ngcontent-%COMP%]{position:relative;width:100%;height:240px}.chart-wrapper[_ngcontent-%COMP%]     .apexcharts-tooltip{background:#1e222b!important;border:1px solid #2c3240!important}.chart-wrapper[_ngcontent-%COMP%]     .apexcharts-tooltip-title{background:#171b22!important;border-bottom:1px solid #2c3240!important}@media (max-width: 992px){.kpi-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(200px,1fr))}.grid-panels[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(280px,1fr))}}@media (max-width: 576px){.hero-text[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.25rem}.kpi-value[_ngcontent-%COMP%]{font-size:1.6rem}.grid-panels[_ngcontent-%COMP%]{grid-template-columns:1fr}}']})}}return t})();var he=[{path:"",redirectTo:"archive",pathMatch:"full"},{path:"archive",component:I,canActivate:[W],data:{allowedRoles:["archivo","archive","director general","subdirector general"]}}],J=(()=>{class t{static{this.\u0275fac=function(p){return new(p||t)}}static{this.\u0275mod=C({type:t})}static{this.\u0275inj=v({imports:[A.forChild(he),A]})}}return t})();var Pe=(()=>{class t{static{this.\u0275fac=function(p){return new(p||t)}}static{this.\u0275mod=C({type:t})}static{this.\u0275inj=v({imports:[R,X,J,I]})}}return t})();export{Pe as DashboardModule};
