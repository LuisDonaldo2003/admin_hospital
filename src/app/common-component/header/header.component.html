<!-- Encabezado principal de la aplicación -->
<header class="app-header" role="banner">
  <div class="header">

    <!-- Sección izquierda: Logo y controles de navegación -->
    <div class="header-left">
      <!-- Logo y nombre del sistema -->
      <a [routerLink]="getHomeRoute()" class="logo" aria-label="Ir a página principal">
        <div class="logo-wrapper">
          <img src="assets/img/logo-hospital.png" alt="SISMEG Logo" class="logo-img" />
        </div>
        <span class="logo-text">SISMEG</span>
      </a>

      <!-- Botón para toggle del sidebar (desktop) -->
      <button type="button" id="toggle_btn" class="sidebar-toggle" aria-label="Alternar menú lateral"
        (click)="toggleSideBar()">
        <img src="assets/img/icons/bar-icon.svg" alt="" />
      </button>
    </div>

    <!-- Botón para toggle del sidebar (móvil) -->
    <button type="button" id="mobile_btn" class="mobile-sidebar-toggle" aria-label="Abrir menú lateral"
      (click)="toggleMobileSideBar()">
      <img src="assets/img/icons/bar-icon.svg" alt="" />
    </button>

    <!-- Sección derecha: Menú de usuario y configuraciones -->
    <nav class="header-right" role="navigation">
      <ul class="nav user-menu">

        <!-- Menú desplegable de usuario -->
        <li class="nav-item dropdown user-profile-dropdown">
          <button type="button" class="user-profile-btn" data-bs-toggle="dropdown" aria-expanded="false"
            aria-label="Menú de usuario">

            <!-- Información del usuario -->
            <div class="user-info">
              <h5 class="user-name">{{ user?.name || 'Usuario' }}</h5>
              <span class="user-role">{{ getRole() }}</span>
            </div>

            <!-- Avatar del usuario - TAMAÑO OPTIMIZADO 65px -->
            <div class="user-avatar-wrapper">
              <img class="user-avatar" width="65" height="65" [src]="avatarUrl" [alt]="user?.name || 'Avatar'"
                (load)="avatarLoading = false" (error)="avatarLoading = false" />
              <!-- Spinner de carga -->
              <span *ngIf="avatarLoading" class="avatar-spinner" role="status" aria-label="Cargando avatar">
              </span>
            </div>
          </button>

          <!-- Opciones del menú desplegable -->
          <ul class="dropdown-menu dropdown-menu-end">
            <li>
              <a class="dropdown-item" [routerLink]="routes.profile" aria-label="Ver perfil">
                <i class="fas fa-user me-2"></i>
                {{ 'HEADER.PROFILES' | translate }}
              </a>
            </li>
            <li>
              <a class="dropdown-item" [routerLink]="routes.editProfile" aria-label="Editar perfil">
                <i class="fas fa-user-edit me-2"></i>
                {{ 'HEADER.EDIT_PROFILE' | translate }}
              </a>
            </li>
            <li>
              <hr class="dropdown-divider">
            </li>
            <li>
              <a class="dropdown-item" href="javascript:void(0)" (click)="logout()" aria-label="Cerrar sesión">
                <i class="fas fa-sign-out-alt me-2"></i>
                {{ 'HEADER.LOGOUT' | translate }}
              </a>
            </li>
          </ul>
        </li>

        <!-- Botón de configuración -->
        <li class="nav-item">
          <a [routerLink]="routes.settings" class="nav-link settings-link" aria-label="Ir a configuración">
            <img src="assets/img/icons/setting-icon-01.svg" alt="" />
          </a>
        </li>
      </ul>
    </nav>

    <!-- Menú móvil (versión simplificada) -->
    <div class="mobile-user-menu">
      <button type="button" class="mobile-menu-toggle" data-bs-toggle="dropdown" aria-expanded="false"
        aria-label="Menú de opciones">
        <i class="fa-solid fa-ellipsis-vertical"></i>
      </button>

      <ul class="dropdown-menu dropdown-menu-end">
        <li>
          <a class="dropdown-item" [routerLink]="routes.profile">
            <i class="fas fa-user me-2"></i>
            {{ 'HEADER.PROFILES' | translate }}
          </a>
        </li>
        <li>
          <a class="dropdown-item" [routerLink]="routes.editProfile">
            <i class="fas fa-user-edit me-2"></i>
            {{ 'HEADER.EDIT_PROFILE' | translate }}
          </a>
        </li>
        <li>
          <hr class="dropdown-divider">
        </li>
        <li>
          <a class="dropdown-item" href="javascript:void(0)" (click)="logout()">
            <i class="fas fa-sign-out-alt me-2"></i>
            {{ 'HEADER.LOGOUT' | translate }}
          </a>
        </li>
      </ul>
    </div>

  </div>
</header>