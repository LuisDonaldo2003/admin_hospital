<div class="page-wrapper pdf-compressor-modern">
  <div class="content">

    <!-- Page Header -->
    <div class="modern-header">
      <div class="header-content">
        <div class="header-left">
          <div class="icon-wrapper">
            <i class="fa fa-file-pdf-o"></i>
            <span class="pulse-ring"></span>
          </div>
          <div class="header-text">
            <h1 class="main-title">{{ 'PERSONAL.PDF_COMPRESSOR.TITLE' | translate }}</h1>
            <p class="subtitle">{{ 'PERSONAL.PDF_COMPRESSOR.SUBTITLE' | translate }}</p>
          </div>
        </div>
        <div class="header-actions" style="display: flex; gap: 0.75rem;">
          <button type="button" class="btn-back" [routerLink]="['/personal/list_personal']">
            <i class="fa fa-arrow-left"></i>
            <span>{{ 'PERSONAL.PDF_COMPRESSOR.GO_TO_LIST' | translate }}</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Mensajes -->
    <div *ngIf="text_validation" class="modern-alert alert-error">
      <div class="alert-icon">
        <i class="fa fa-exclamation-circle"></i>
      </div>
      <div class="alert-content">
        <strong>{{ 'PERSONAL.PDF_COMPRESSOR.ERROR' | translate }}:</strong> {{ text_validation }}
      </div>
      <button type="button" class="alert-close" (click)="text_validation = ''">
        <i class="fa fa-times"></i>
      </button>
    </div>

    <div *ngIf="text_success" class="modern-alert alert-success">
      <div class="alert-icon">
        <i class="fa fa-check-circle"></i>
      </div>
      <div class="alert-content">
        <strong>{{ 'PERSONAL.PDF_COMPRESSOR.SUCCESS' | translate }}</strong> {{ text_success }}
      </div>
      <button type="button" class="alert-close" (click)="text_success = ''">
        <i class="fa fa-times"></i>
      </button>
    </div>

    <!-- Main Content -->
    <div class="main-container">

      <!-- Upload Zone -->
      <div class="upload-container">
        <div class="dropzone" [class.drag-active]="isDragOver" (dragover)="onDragOver($event)"
          (dragleave)="onDragLeave($event)" (drop)="onDrop($event)">

          <div class="dropzone-icon">
            <div class="icon-circle">
              <i class="fa fa-cloud-upload"></i>
            </div>
          </div>

          <h3 class="dropzone-title">{{ 'PERSONAL.PDF_COMPRESSOR.DRAG_DROP_FILES' | translate }}</h3>
          <p class="dropzone-text">{{ 'PERSONAL.PDF_COMPRESSOR.OR_SELECT_FROM_COMPUTER' | translate }}</p>

          <input type="file" id="pdfFiles" class="file-input" accept=".pdf" multiple (change)="onFileSelected($event)">

          <label for="pdfFiles" class="btn-select">
            <i class="fa fa-folder-open me-2"></i>
            {{ 'PERSONAL.PDF_COMPRESSOR.BROWSE_FILES' | translate }}
          </label>

          <div class="dropzone-info">
            <span><i class="fa fa-info-circle"></i> {{ 'PERSONAL.PDF_COMPRESSOR.FORMAT_PDF' | translate }}</span>
            <span><i class="fa fa-hdd-o"></i> {{ 'PERSONAL.PDF_COMPRESSOR.MAX_10MB' | translate }}</span>
          </div>
        </div>
      </div>

      <!-- Lista de archivos seleccionados -->
      <div *ngIf="selectedFiles.length > 0" class="files-container">
        <div class="section-title">
          <div class="title-left">
            <i class="fa fa-files-o"></i>
            <h3>{{ 'PERSONAL.PDF_COMPRESSOR.SELECTED_FILES' | translate }}</h3>
            <span class="count-badge">{{ selectedFiles.length }}</span>
          </div>
          <div class="title-actions">
            <button type="button" class="btn-action btn-compress" [disabled]="isProcessing" (click)="compressAll()">
              <i class="fa fa-compress"></i>
              <span *ngIf="!isProcessing">{{ 'PERSONAL.PDF_COMPRESSOR.COMPRESS_ALL' | translate }}</span>
              <span *ngIf="isProcessing">
                <span class="spinner"></span>
                {{ 'PERSONAL.PDF_COMPRESSOR.PROCESSING' | translate }}
              </span>
            </button>
            <button type="button" class="btn-action btn-clear" [disabled]="isProcessing" (click)="clearAll()">
              <i class="fa fa-trash-o"></i>
              <span>{{ 'PERSONAL.PDF_COMPRESSOR.CLEAR' | translate }}</span>
            </button>
          </div>
        </div>

        <div class="files-grid">
          <div class="file-card" *ngFor="let file of selectedFiles; let i = index">
            <div class="file-preview">
              <i class="fa fa-file-pdf-o"></i>
            </div>
            <div class="file-details">
              <h4 class="file-name" [title]="file.name">{{ file.name }}</h4>
              <div class="file-meta">
                <span class="file-size" [class.size-danger]="file.size > MAX_FILE_SIZE"
                  [class.size-warning]="file.size <= MAX_FILE_SIZE && file.size > MAX_FILE_SIZE * 0.8"
                  [class.size-success]="file.size <= MAX_FILE_SIZE * 0.8">
                  <i class="fa fa-database"></i>
                  {{ formatFileSize(file.size) }}
                </span>
              </div>
            </div>
            <button type="button" class="btn-remove" [disabled]="isProcessing" (click)="removeFile(i)"
              title="{{ 'PERSONAL.PDF_COMPRESSOR.DELETE' | translate }}">
              <i class="fa fa-times"></i>
            </button>
          </div>
        </div>
      </div>

      <!-- Resultados de la compresión -->
      <div *ngIf="compressedFiles.length > 0" class="results-container">
        <div class="section-title">
          <div class="title-left">
            <i class="fa fa-check-circle"></i>
            <h3>{{ 'PERSONAL.PDF_COMPRESSOR.COMPRESSED_FILES' | translate }}</h3>
            <span class="count-badge success">{{ compressedFiles.length }}</span>
          </div>
          <button type="button" class="btn-action btn-download-all" (click)="downloadAll()">
            <i class="fa fa-download"></i>
            <span>{{ 'PERSONAL.PDF_COMPRESSOR.DOWNLOAD_ALL' | translate }}</span>
          </button>
        </div>

        <!-- Estadísticas -->
        <div class="stats-grid">
          <div class="stat-item stat-original">
            <div class="stat-icon">
              <i class="fa fa-file-o"></i>
            </div>
            <div class="stat-info">
              <span class="stat-label">{{ 'PERSONAL.PDF_COMPRESSOR.ORIGINAL_SIZE' | translate }}</span>
              <h3 class="stat-value">{{ formatFileSize(totalOriginalSize) }}</h3>
            </div>
          </div>

          <div class="stat-item stat-compressed">
            <div class="stat-icon">
              <i class="fa fa-compress"></i>
            </div>
            <div class="stat-info">
              <span class="stat-label">{{ 'PERSONAL.PDF_COMPRESSOR.COMPRESSED_SIZE' | translate }}</span>
              <h3 class="stat-value">{{ formatFileSize(totalCompressedSize) }}</h3>
            </div>
          </div>

          <div class="stat-item stat-reduction">
            <div class="stat-icon">
              <i class="fa fa-line-chart"></i>
            </div>
            <div class="stat-info">
              <span class="stat-label">{{ 'PERSONAL.PDF_COMPRESSOR.TOTAL_REDUCTION' | translate }}</span>
              <h3 class="stat-value">{{ getReductionPercent(totalOriginalSize, totalCompressedSize) }}%</h3>
            </div>
          </div>
        </div>

        <!-- Lista de archivos comprimidos -->
        <div class="compressed-list">
          <div class="compressed-item" *ngFor="let file of compressedFiles">
            <div class="compressed-header">
              <div class="compressed-name">
                <i class="fa fa-file-pdf-o"></i>
                <span>{{ file.name }}</span>
              </div>
              <button type="button" class="btn-download" (click)="downloadCompressed(file)">
                <i class="fa fa-download"></i>
              </button>
            </div>

            <div class="compressed-data">
              <div class="data-col">
                <span class="data-label">{{ 'PERSONAL.PDF_COMPRESSOR.ORIGINAL' | translate }}</span>
                <span class="data-value">{{ formatFileSize(file.originalSize) }}</span>
              </div>

              <div class="data-col">
                <span class="data-label">{{ 'PERSONAL.PDF_COMPRESSOR.COMPRESSED' | translate }}</span>
                <span class="data-value compressed">{{ formatFileSize(file.compressedSize) }}</span>
              </div>

              <div class="data-col">
                <span class="data-label">{{ 'PERSONAL.PDF_COMPRESSOR.REDUCTION' | translate }}</span>
                <span class="data-value reduction">-{{ getReductionPercent(file.originalSize, file.compressedSize)
                  }}%</span>
              </div>

              <div class="data-col">
                <span *ngIf="meetsLimit(file.compressedSize)" class="status-badge success">
                  <i class="fa fa-check"></i>
                  ≤ 500KB
                </span>
                <span *ngIf="!meetsLimit(file.compressedSize)" class="status-badge warning">
                  <i class="fa fa-exclamation-triangle"></i>
                  > 500KB
                </span>
              </div>
            </div>
          </div>
        </div>

        <!-- Advertencia -->
        <div *ngIf="hasFilesOverLimit()" class="modern-alert alert-warning">
          <div class="alert-icon">
            <i class="fa fa-exclamation-triangle"></i>
          </div>
          <div class="alert-content">
            <strong>{{ 'PERSONAL.PDF_COMPRESSOR.ATTENTION' | translate }}:</strong> {{
            'PERSONAL.PDF_COMPRESSOR.FILES_OVER_LIMIT_MESSAGE' | translate }}
          </div>
        </div>
      </div>

      <!-- Información y Consejos -->
      <div class="info-grid">
        <div class="info-card">
          <div class="info-header">
            <i class="fa fa-lightbulb-o"></i>
            <h4>{{ 'PERSONAL.PDF_COMPRESSOR.HOW_IT_WORKS' | translate }}</h4>
          </div>
          <ul class="info-list">
            <li>{{ 'PERSONAL.PDF_COMPRESSOR.HOW_STEP1' | translate }}</li>
            <li>{{ 'PERSONAL.PDF_COMPRESSOR.HOW_STEP2' | translate }}</li>
            <li>{{ 'PERSONAL.PDF_COMPRESSOR.HOW_STEP3' | translate }}</li>
            <li>{{ 'PERSONAL.PDF_COMPRESSOR.HOW_STEP4' | translate }}</li>
          </ul>
        </div>

        <div class="info-card">
          <div class="info-header">
            <i class="fa fa-star"></i>
            <h4>{{ 'PERSONAL.PDF_COMPRESSOR.RECOMMENDATIONS' | translate }}</h4>
          </div>
          <ul class="info-list">
            <li>{{ 'PERSONAL.PDF_COMPRESSOR.REC1' | translate }} <strong>{{ 'PERSONAL.PDF_COMPRESSOR.BLACK_WHITE' |
                translate }}</strong> {{ 'PERSONAL.PDF_COMPRESSOR.FOR_COMPRESSION' | translate }}</li>
            <li>{{ 'PERSONAL.PDF_COMPRESSOR.REC2' | translate }} <strong>150-200 DPI</strong> {{
              'PERSONAL.PDF_COMPRESSOR.FOR_TEXT_DOCS' | translate }}</li>
            <li>{{ 'PERSONAL.PDF_COMPRESSOR.REC3' | translate }}</li>
            <li>{{ 'PERSONAL.PDF_COMPRESSOR.REC4' | translate }}</li>
          </ul>
        </div>
      </div>

    </div>

  </div>
</div>

<!-- Botón flotante de ayuda para iniciar el tour -->
<button class="tour-help-button" (click)="startPdfCompressorTour()" title="{{ 'TOUR.HELP_BUTTON' | translate }}"
  type="button">
  <i class="fa fa-question"></i>
</button>