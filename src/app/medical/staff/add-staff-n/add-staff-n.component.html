<!--
  Contenedor principal de la página de agregar staff
-->
<div class="page-wrapper">
  <!-- Sección del contenido principal y formulario -->
  <div class="content add-staff-form">
    <!-- Encabezado de la página con breadcrumb de navegación -->
    <div class="page-header mb-4">
      <div class="row">
        <div class="col-sm-12">
          <!-- Breadcrumb para mostrar la ruta de navegación -->
          <ol class="breadcrumb bg-light p-2 rounded">
            <li class="breadcrumb-item">
              <!-- Enlace al listado de usuarios -->
              <a href="#">{{ 'STAFF.ADD_STAFF.BREADCRUMB_USERS' | translate }} ></a>
            </li>
            <li class="breadcrumb-item active">
              <!-- Texto del breadcrumb para agregar staff -->
              {{ 'STAFF.ADD_STAFF.BREADCRUMB_ADD_STAFF' | translate }}
            </li>
          </ol>
        </div>
      </div>
    </div>

    <!-- Sección central del formulario -->
    <div class="row justify-content-center">
      <div class="col-lg-10 col-xl-8">
        <!-- Card que contiene el formulario -->
        <div class="card card-form shadow border-0">
          <div class="card-body p-4">
            <!-- Encabezado del formulario con icono -->
            <div class="form-header text-center mb-4">
              <div class="form-icon mb-3">
                <i class="fa fa-user-plus"></i>
              </div>
              <h3 class="fw-bold mb-2">{{ 'STAFF.ADD_STAFF.TITLE' | translate }}</h3>
              <p class="text-muted small">{{ 'STAFF.ADD_STAFF.DESCRIPTION' | translate }}</p>
            </div>

            <!-- Formulario para agregar staff -->
            <form>
              <!-- Sección: Información Personal -->
              <div class="form-section">
                <div class="section-header mb-3">
                  <h5 class="section-title">
                    <i class="fa fa-user me-2"></i>{{ 'STAFF.ADD_STAFF.PERSONAL_INFORMATION' | translate }}
                  </h5>
                </div>
                <div class="row g-3">
                  <!-- Campo para el nombre -->
                  <div class="col-md-6">
                    <label class="form-label">
                      <i class="fa fa-id-card me-1"></i>{{ 'STAFF.ADD_STAFF.FIRST_NAME' | translate }} <span
                        class="text-danger">*</span>
                    </label>
                    <input type="text" class="form-control" [(ngModel)]="name" name="name" required
                      placeholder="{{ 'STAFF.ADD_STAFF.NAME_PLACEHOLDER' | translate }}"
                      [ngClass]="{ 'is-invalid': submitted && !name.trim() }" />
                    <div class="invalid-feedback" *ngIf="submitted && !name.trim()">{{ 'STAFF.ADD_STAFF.NAME_REQUIRED' |
                      translate }}</div>
                  </div>

                  <!-- Campo para el apellido -->
                  <div class="col-md-6">
                    <label class="form-label">
                      <i class="fa fa-id-card me-1"></i>{{ 'STAFF.ADD_STAFF.SURNAME' | translate }} <span
                        class="text-danger">*</span>
                    </label>
                    <input type="text" class="form-control" [(ngModel)]="surname" name="surname" required
                      placeholder="{{ 'STAFF.ADD_STAFF.SURNAME_PLACEHOLDER' | translate }}"
                      [ngClass]="{ 'is-invalid': submitted && !surname.trim() }" />
                    <div class="invalid-feedback" *ngIf="submitted && !surname.trim()">{{
                      'STAFF.ADD_STAFF.SURNAME_REQUIRED' | translate }}</div>
                  </div>

                  <!-- Campo para el correo electrónico -->
                  <div class="col-12">
                    <label class="form-label">
                      <i class="fa fa-envelope me-1"></i>{{ 'STAFF.ADD_STAFF.EMAIL' | translate }} <span
                        class="text-danger">*</span>
                    </label>
                    <input type="email" class="form-control" [(ngModel)]="email" name="email" required
                      placeholder="{{ 'STAFF.ADD_STAFF.EMAIL_PLACEHOLDER' | translate }}"
                      [ngClass]="{ 'is-invalid': submitted && !email.trim() }" />
                    <div class="invalid-feedback" *ngIf="submitted && !email.trim()">{{ 'STAFF.ADD_STAFF.EMAIL_REQUIRED'
                      | translate }}</div>
                  </div>
                </div>
              </div>

              <!-- Separador -->
              <div class="form-divider my-4"></div>

              <!-- Sección: Rol y Seguridad -->
              <div class="form-section">
                <div class="section-header mb-3">
                  <h5 class="section-title">
                    <i class="fa fa-shield-alt me-2"></i>{{ 'STAFF.ADD_STAFF.ROLE_SECURITY' | translate }}
                  </h5>
                </div>
                <div class="row g-3">
                  <!-- Selección de rol para el staff -->
                  <div class="col-12">
                    <label class="form-label">
                      <i class="fa fa-user-tag me-1"></i>{{ 'STAFF.ADD_STAFF.ROLE_SELECT' | translate }} <span
                        class="text-danger">*</span>
                    </label>
                    <select class="form-control form-select" [(ngModel)]="selectedValue" name="role" required
                      [ngClass]="{ 'is-invalid': submitted && !selectedValue }">
                      <!-- Opción por defecto -->
                      <option value="" disabled hidden>{{ 'STAFF.ADD_STAFF.SELECT_ROLE_PLACEHOLDER' | translate }}
                      </option>
                      <!-- Opciones de roles disponibles -->
                      <option *ngFor="let data of roles" [value]="data.id">{{ data.name }}</option>
                    </select>
                    <div class="invalid-feedback" *ngIf="submitted && !selectedValue">{{ 'STAFF.ADD_STAFF.ROLE_REQUIRED'
                      | translate }}</div>
                  </div>

                  <!-- Campo para la contraseña -->
                  <div class="col-md-6">
                    <label class="form-label">
                      <i class="fa fa-lock me-1"></i>{{ 'STAFF.ADD_STAFF.PASSWORD' | translate }} <span
                        class="text-danger">*</span>
                    </label>
                    <input type="password" class="form-control" [(ngModel)]="password" name="password" required
                      placeholder="{{ 'STAFF.ADD_STAFF.PASSWORD_PLACEHOLDER' | translate }}"
                      [ngClass]="{ 'is-invalid': submitted && !password.trim() }" />
                    <div class="invalid-feedback" *ngIf="submitted && !password.trim()">{{
                      'STAFF.ADD_STAFF.PASSWORD_REQUIRED' | translate }}</div>
                  </div>

                  <!-- Campo para confirmar la contraseña -->
                  <div class="col-md-6">
                    <label class="form-label">
                      <i class="fa fa-lock me-1"></i>{{ 'STAFF.ADD_STAFF.CONFIRM_PASSWORD' | translate }} <span
                        class="text-danger">*</span>
                    </label>
                    <input type="password" class="form-control" [(ngModel)]="password_confirmation"
                      name="password_confirmation" required
                      placeholder="{{ 'STAFF.ADD_STAFF.CONFIRM_PASSWORD_PLACEHOLDER' | translate }}"
                      [ngClass]="{ 'is-invalid': submitted && !password_confirmation.trim() }" />
                    <div class="invalid-feedback" *ngIf="submitted && !password_confirmation.trim()">{{
                      'STAFF.ADD_STAFF.CONFIRM_PASSWORD_REQUIRED' | translate }}</div>
                  </div>
                </div>
              </div>

              <!-- Alerta de éxito -->
              @if (showSuccess) {
              <div class="mt-4">
                <div class="alert alert-success alert-dismissible fade show" role="alert">
                  <strong><i class="fa fa-check-circle me-2"></i>{{ 'STAFF.ADD_STAFF.SUCCESS' | translate }}!</strong>
                  {{ 'STAFF.ADD_STAFF.USER_CREATED_SUCCESS' | translate }}
                  <button type="button" class="btn-close" (click)="showSuccess = false" aria-label="Cerrar"></button>
                </div>
              </div>
              }

              <!-- Alerta de validación/error -->
              @if (showValidation) {
              <div class="mt-4">
                <div class="alert alert-warning alert-dismissible fade show" role="alert">
                  <strong><i class="fa fa-exclamation-triangle me-2"></i>{{ 'STAFF.ADD_STAFF.WARNING' | translate
                    }}:</strong>
                  <ng-container [ngSwitch]="validationType">
                    <span *ngSwitchCase="'missing'">{{ 'STAFF.ADD_STAFF.FILL_REQUIRED_FIELDS' | translate }}</span>
                    <span *ngSwitchCase="'password_mismatch'">{{ 'STAFF.ADD_STAFF.PASSWORD_MISMATCH' | translate
                      }}</span>
                    <span *ngSwitchCase="'permission'">{{ backendErrorText }}</span>
                    <span *ngSwitchDefault>{{ 'STAFF.ADD_STAFF.UNKNOWN_VALIDATION' | translate }}</span>
                  </ng-container>
                  <button type="button" class="btn-close" (click)="showValidation = false; validationType = 'none'"
                    aria-label="Cerrar"></button>
                </div>
              </div>
              }

              <!-- Botones de acción -->
              <div class="form-actions d-flex justify-content-end gap-2 mt-4">
                <button type="button" class="btn btn-cancel" routerLink="/staffs/list-staff">
                  <i class="fa fa-times me-2"></i>{{ 'STAFF.ADD_STAFF.CANCEL' | translate }}
                </button>
                <button type="button" class="btn btn-save" (click)="save()">
                  <i class="fa fa-save me-2"></i>{{ 'STAFF.ADD_STAFF.SAVE' | translate }}
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Botón flotante de ayuda para iniciar el tour -->
<button class="tour-help-button" (click)="startStaffFormTour()" title="{{ 'TOUR.HELP_BUTTON' | translate }}"
  type="button">
  <i class="fa fa-question"></i>
</button>